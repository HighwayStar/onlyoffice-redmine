<%#
# (c) Copyright Ascensio System SIA 2022
# http://www.onlyoffice.com
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
%>

    <h2><%= l(:onlyoffice_convert_dropdown) %></h2>
    <h2><%= @file.filename %></h2>

<%= form_tag(onlyoffice_convert_path(@page.id), multipart: true, id: "conversion") do |f| %>
    <%= hidden_field_tag 'back_page', back_url %>
    <%= render :partial => 'form', :locals => {:f => f} %>
    <div style = "display: flex; align-items: center;" >
        <p><%= submit_tag l(:onlyoffice_convert_submit) %></p>
        <p><%= submit_tag l(:label_no_preview_download) %></p>
        <p><%= link_to l(:button_cancel), back_url %></p>
        <div id="progress_bar">
            <div id="progress"></div>
            <%= label_tag "progress", "0%" %>
        </div>
    </div>

<% end %>

<script type="text/javascript" language="javascript">
    var t = "<%= @file.project.id %>";
    console.log(t)

    var form = $('#conversion')[0]

    form.addEventListener("submit", function() {
        form.submit();
    }, false );

</script>

<style>
    form#conversion div p {
        padding-right: 1%;
    }

    #progress_bar{
        padding-left: 3%;
        display: flex;
        width: 100%;
    }

    #progress_bar label{
        padding-left: 1%;
    }

    #progress {
        background: #EEEEEE;
        height: 16px;
        width: 60%;
    }

    #progress:after {
        content: '';
        display: block;
        background: #BAE0BA;
        width: 0%;
        height: 100%;
    }
</style>